<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">
<node>
  <!--
    pl.jkolo.yubikey.oath.Credential:
    @short_description: Credential interface for individual OATH credential

    This interface represents a single OATH credential (TOTP/HOTP) on a YubiKey/Nitrokey.
    Each credential is available at path:
    /pl/jkolo/yubikey/oath/devices/<deviceId>/credentials/<credentialId>

    All methods are asynchronous (NoReply=true) - results delivered via signals.
  -->
  <interface name="pl.jkolo.yubikey.oath.Credential">

    <!-- Async Methods (all return immediately, results via signals) -->
    <method name="GenerateCode">
      <annotation name="org.freedesktop.DBus.Method.NoReply" value="true"/>
      <!-- Returns immediately. Result emitted via CodeGenerated signal -->
    </method>

    <method name="CopyToClipboard">
      <annotation name="org.freedesktop.DBus.Method.NoReply" value="true"/>
      <!-- Returns immediately. Result emitted via ClipboardCopied signal -->
    </method>

    <method name="TypeCode">
      <arg direction="in" type="b" name="fallbackToCopy"/>
      <annotation name="org.freedesktop.DBus.Method.NoReply" value="true"/>
      <!-- Returns immediately. Result emitted via CodeTyped signal -->
    </method>

    <method name="Delete">
      <annotation name="org.freedesktop.DBus.Method.NoReply" value="true"/>
      <!-- Returns immediately. Result emitted via Deleted signal -->
    </method>

    <!-- Result Signals -->
    <signal name="CodeGenerated">
      <arg type="s" name="code"/>
      <arg type="x" name="validUntil"/>
      <arg type="s" name="error"/>
      <!-- Emitted when code generation completes. error is empty on success -->
    </signal>

    <signal name="ClipboardCopied">
      <arg type="b" name="success"/>
      <arg type="s" name="error"/>
      <!-- Emitted when clipboard copy completes. error is empty on success -->
    </signal>

    <signal name="CodeTyped">
      <arg type="b" name="success"/>
      <arg type="s" name="error"/>
      <!-- Emitted when code typing completes. error is empty on success -->
    </signal>

    <signal name="Deleted">
      <arg type="b" name="success"/>
      <arg type="s" name="error"/>
      <!-- Emitted when deletion completes. error is empty on success -->
    </signal>

    <!-- Workflow Status Signals -->
    <signal name="TouchRequired">
      <arg type="i" name="timeoutSeconds"/>
      <arg type="s" name="deviceModel"/>
      <!-- Emitted when user needs to touch the device.
           Client can show custom notification or rely on daemon's notification. -->
    </signal>

    <signal name="TouchCompleted">
      <arg type="b" name="success"/>
      <!-- Emitted when touch workflow completes.
           success=true: touch detected, operation continuing
           success=false: cancelled or timeout -->
    </signal>

    <signal name="ReconnectRequired">
      <arg type="s" name="deviceModel"/>
      <!-- Emitted when device needs to be reconnected.
           Client can show custom notification or rely on daemon's notification. -->
    </signal>

    <signal name="ReconnectCompleted">
      <arg type="b" name="success"/>
      <!-- Emitted when reconnect workflow completes.
           success=true: device reconnected, operation continuing
           success=false: cancelled by user -->
    </signal>

    <!-- Properties -->
    <property name="FullName" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Issuer" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Username" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="RequiresTouch" type="b" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Type" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Algorithm" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Digits" type="i" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="Period" type="i" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

    <property name="DeviceId" type="s" access="read">
      <annotation name="org.freedesktop.DBus.Property.EmitsChangedSignal" value="const"/>
    </property>

  </interface>

  <!-- Note: Standard D-Bus interfaces (Properties, Introspectable, Peer)
       are handled automatically by Qt's meta-object system and do not need XML definitions
       for adaptor generation. They are implemented in the C++ class. -->

</node>
